<html>

<head>
  <link rel="stylesheet" href="/assets/normalize.css">
  <link rel="stylesheet" href="/assets/magick.css">
</head>

<body>
  <main>
    <section>
      <blockquote>
        <p>
          Cast your gaze past the veiled sky, where clouds dance in whispers and secrets. In the realms of exploration, they are not barriers, but
          ephemeral thresholds to realms unseen, waiting for those who dare to rise and unveil the mysteries that lie beyond.
        </p>
        <footer>ChatGPT 3.5, 2024</footer>
      </blockquote>
    </section>
    <pre><code>import { Netmask } from "netmask";

const server = Bun.serve({
  fetch(req) {
    const url = new URL(req.url);

    if (url.pathname.startsWith("/assets/")) {
      const asset = new URL(req.url).pathname;
      return new Response(Bun.file(import.meta.dir + asset));
    }

    if (url.pathname.endsWith("/")) {
      const index = "/views/index.html";
      return new Response(Bun.file(import.meta.dir + index));
    }

    if (url.pathname.endsWith("/spell")) {
      const reqIP = server.requestIP(req);
      const allowed = [
        "103.21.244.0/22",
        "103.22.200.0/22",
        "103.31.4.0/22",
        "104.16.0.0/13",
        "104.24.0.0/14",
        "108.162.192.0/18",
        "131.0.72.0/22",
        "141.101.64.0/18",
        "162.158.0.0/15",
        "172.64.0.0/13",
        "173.245.48.0/20",
        "188.114.96.0/20",
        "190.93.240.0/20",
        "197.234.240.0/22",
        "198.41.128.0/17",
      ].map((s) => new Netmask(s));

      try {
        if (allowed.some((a) => a.contains(reqIP?.address ?? ""))) {
          const spell = "/views/spell.html";
          return new Response(Bun.file(import.meta.dir + spell));
        }
      } catch {}
      const denied = "/views/denied.html";
      return new Response(Bun.file(import.meta.dir + denied));
    }

    return Response.redirect("/", 301);
  },
  port: Bun.env.BUN_SERVER_PORT ?? 3000,
});
</code></pre>
  </main>
</body>

</html>